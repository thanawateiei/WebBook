@model WebBook.ViewModels.BookViewModel

@{
	Layout = "~/Views/Shared/_AdminLayout.cshtml";
	ViewData["Title"] = "Edit";
}

<h1>Edit</h1>

<hr />
<div class="row">
	<div class="col-12">
		<form enctype="multipart/form-data" asp-action="Edit">

			<div asp-validation-summary="ModelOnly" class="text-danger"></div>
			<div class="row">
				<div class="col-md-6">
					<div class="form-group">
						<label asp-for="BookId" class="control-label"></label>
						<input asp-for="BookId" class="form-control" readonly  />
						<span asp-validation-for="BookId" class="text-danger"></span>
					</div>
					<div class="form-group">
						<label asp-for="BookName" class="control-label"></label>
						<input asp-for="BookName" class="form-control" />
						<span asp-validation-for="BookName" class="text-danger"></span>
					</div>
					<div class="form-group">
						<label asp-for="AuthorName" class="control-label"></label>
						<input asp-for="AuthorName" class="form-control" />
						<span asp-validation-for="AuthorName" class="text-danger"></span>
					</div>
					<div class="form-group">
						<label asp-for="PublicationYear" class="control-label"></label>
						<input asp-for="PublicationYear" class="form-control" />
						<span asp-validation-for="PublicationYear" class="text-danger"></span>
					</div>
					<div class="form-group">
						<label asp-for="Publisher" class="control-label"></label>
						<input asp-for="Publisher" class="form-control" />
						<span asp-validation-for="Publisher" class="text-danger"></span>
					</div>
					<div class="form-group">
						@*<label asp-for="BookCover" class="control-label"></label>*@
						<input asp-for="BookCover" hidden class="form-control" />
						@*<span asp-validation-for="BookCover" class="text-danger"></span>*@
					</div>
					<div class="form-group">
						<label asp-for="BookDetail" class="control-label"></label>
						<textarea  asp-for="BookDetail" class="form-control" ></textarea>
						<span asp-validation-for="BookDetail" class="text-danger"></span>
					</div>

					<div class="form-group">
						<input asp-for="BookType1" id="BookType1" hidden class="form-control" />
					</div>
					<div class="form-group">
						<input asp-for="BookType2" id="BookType2" hidden class="form-control" />
					</div>
					<div class="form-group">
						<input asp-for="BookType3" id="BookType3" hidden class="form-control" />
					</div>
					<div class="form-group">
						<input asp-for="BookType4" id="BookType4" hidden class="form-control" />
					</div>
					<div class="form-group">
						<input asp-for="BookType5" id="BookType5" hidden class="form-control" />
					</div>
					<div class="form-group">
						<input asp-for="BookType6" id="BookType6" hidden class="form-control" />
					</div>
					<div class="form-group">
						<input asp-for="BookType7" id="BookType7" hidden class="form-control" />
					</div>
					<div class="form-group">
						<input asp-for="BookType8" id="BookType8" hidden class="form-control" />
					</div>
					<div class="form-group">
						<input asp-for="BookType9" id="BookType9" hidden class="form-control" />
					</div>
					<div class="form-group">
						<input asp-for="BookType10" id="BookType10" hidden class="form-control" />
					</div>

					<div class="row">
						@{
							var countBT = 1;
						}
						@foreach (var item in ViewBag.BTT)
						{
							
							var setid = "val_BT" + countBT;
							var setid2 = "checkBT" + countBT;
					
							<div class="col-6">
								<label for="@setid2">
									<input type="checkbox" id="@setid2" class="checkBT" />
									@item.Text
								</label>
							@*	@if(Model.BookType1)
								{
									
								}*@
								<input type="text" id="@setid" hidden value="@item.Value" />
						
							</div>
							countBT ++;
						}
						<input type="text" id="countBT" hidden value="@countBT"/>

					</div>
				</div>
				<div class="col-md-5">
					<div class="form-group ">
						<input class="countimg" hidden value="1" />
						<label asp-for="Bookimg" class="control-label"></label>
						<input asp-for="Bookimg" id="showimg" class="form-control" />
						<span asp-validation-for="Bookimg" class="text-danger"></span>
						@{
							var imgbook = "/img/imgbook/" + @Model.BookCover;
						}	
						<img id='blah' class='img-fluid'src='@imgbook' alt=''/>
					</div>
					<div class="imgshow "></div>
				</div>
			</div>
			<br />
			<div class="form-group">
				<input type="submit" value="Edit" class="btn btn-primary" />
			</div>
			

		</form>
	</div>
</div>

<div>
	<a asp-action="Index">Back to List</a>
</div>
<script type="text/javascript">
	$( document ).ready(function() {
				//set();
			   $("#showimg").change(function(){
					console.log("showimg");
					readURL(this);
				});
				
				
				 $(".checkBT").change(function(){
					// console.log("checkBT");
				
					var conVal = 1;
					var countBT = ($("#countBT").val())-1;
					
					//console.log('countBT  '+countBT);
					for(var i=1 ; i <= countBT ;i++){

						var y = "#checkBT"+i;
						var check = $(y).prop('checked');
						if(check == true && conVal <= 10){
							var setdata = "#BookType"+conVal;
							var setid = "#val_BT"+i;
							var data = $(setid).val();
							$(setdata).val(data);
							//console.log(setdata);
							//console.log(data);
							conVal++;
						}
						else if(check == false && conVal <= 10){
							var setdata = "#BookType"+conVal;
							var setid = "#val_BT"+i;
							var data = $(setid).val();
							$(setdata).val(0);
							//console.log(setdata);
							//console.log(data);
							conVal++;
						}
						
					}
				});

	

	});// END document  ready


function readURL(input) {

			if (input.files && input.files[0]) {
				var c = $(".countimg").val();
			//alert("asdf");
				var reader = new FileReader();
				reader.onload = function (e) {
					$('#blah').attr('src', e.target.result);
				}

					reader.readAsDataURL(input.files[0]);
				}
			}



//function setBT(){
//			var i = 1;
		   

//}

</script>
@*@section Scripts {
	@{
	await Html.RenderPartialAsync("_ValidationScriptsPartial");
	}
	}*@
